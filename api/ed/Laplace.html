<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Edward – ed.Laplace</title>
  <!-- Mobile Specific Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT -->
  <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/skeleton.css">
  <!-- Dynamically resize logo for mobile -->
  <style type="text/css">
  .logo-width {
    width: 100%;
    box-sizing: border-box;
    margin-bottom: 15%;
  }
  /* Roughly the point when website is single column */
  @media (max-width: 850px) {
    .logo-width {
      width: 50%;
      box-sizing: border-box;
      margin-bottom: 5%;
    }
  }
  /* Downgrade API's header styles without explicitly modifying their type. */
  div.nine.columns h1 { text-align: left; }
  div.nine.columns h1 { font-size: 3.0rem; line-height: 1.25; letter-spacing: -.1rem; }
  div.nine.columns h2 { font-size: 2.4rem; line-height: 1.3;  letter-spacing: -.1rem; }
  div.nine.columns h3 { font-size: 2.4rem; line-height: 1.35; letter-spacing: -.08rem; }
  div.nine.columns h4 { font-size: 1.8rem; line-height: 1.5;  letter-spacing: -.05rem; }
  div.nine.columns h5 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }
  @media (min-width: 550px) {
    div.nine.columns h1 { font-size: 3.6rem; }
    div.nine.columns h2 { font-size: 3.0rem; }
    div.nine.columns h3 { font-size: 3.0rem; }
    div.nine.columns h4 { font-size: 2.5rem; }
    div.nine.columns h5 { font-size: 1.5rem; }
  }
  </style>

  <!-- KaTeX -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js"></script>

  <!-- highlight.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/icons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/icons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/icons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/icons/manifest.json">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/icons/mstile-144x144.png">
  <meta name="msapplication-config" content="/icons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div class="container">
  <div class="row" style="margin-top: 5%">
    <div class="three columns">
    <h1><a href="/">Edward</a></h1>
    <a href="/">
    <center>
      <img src="/images/edward.png" class="logo-width" alt="Edward" />
    </center>
    </a>
    <a class="button u-full-width" href="/api/">API</a>
    <hr style="margin-top: 1rem; margin-bottom: 1.5rem;"/>
    <a class="button u-full-width" href="/api/reference">Reference</a>
    <a class="button u-full-width" href="/api/ed/criticisms">ed.criticisms</a>
<a class="button u-full-width" href="/api/ed/inferences">ed.inferences</a>
<a class="button u-full-width" href="/api/ed/models">ed.models</a>
<a class="button u-full-width" href="/api/ed/util">ed.util</a>
<a class="button u-full-width" href="/api/observations">observations</a>

    <div class="row" style="padding-bottom: 5%"> </div>
    <a class="button2 u-pull-right" style="padding-right:10%"
      href="https://github.com/blei-lab/edward">
      <span style="vertical-align:middle;">Github</span>&nbsp;
      <img src="/images/github-mark.svg" style="vertical-align:middle;"
      alt="Edward on Github" />
    </a>
    <div class="row" style="padding-bottom: 5%"> </div>
    </div>
    <div class="nine columns">

<div itemscope itemtype="http://developers.google.com/ReferenceObject">
<meta itemprop="name" content="ed.Laplace" />
<meta itemprop="property" content="__init__"/>
<meta itemprop="property" content="build_loss_and_gradients"/>
<meta itemprop="property" content="finalize"/>
<meta itemprop="property" content="initialize"/>
<meta itemprop="property" content="print_progress"/>
<meta itemprop="property" content="run"/>
<meta itemprop="property" content="update"/>
</div>
<h1 id="ed.laplace">ed.Laplace</h1>
<h2 id="class-laplace">Class <code>Laplace</code></h2>
<p>Inherits From: <a href="../ed/MAP"><code>MAP</code></a></p>
<h3 id="aliases">Aliases:</h3>
<ul>
<li>Class <code>ed.Laplace</code></li>
<li>Class <code>ed.inferences.Laplace</code></li>
</ul>
<p>Defined in <a href="https://github.com/blei-lab/edward/tree/master/edward/inferences/laplace.py"><code>edward/inferences/laplace.py</code></a>.</p>
<p>Laplace approximation <span class="citation" data-cites="laplace1986memoir">(Laplace, 1986)</span>.</p>
<p>It approximates the posterior distribution using a multivariate normal distribution centered at the mode of the posterior.</p>
<p>We implement this by running <code>MAP</code> to find the posterior mode. This forms the mean of the normal approximation. We then compute the inverse Hessian at the mode of the posterior. This forms the covariance of the normal approximation.</p>
<h4 id="notes">Notes</h4>
<p>If <code>MultivariateNormalDiag</code> or <code>Normal</code> random variables are specified as approximations, then the Laplace approximation will only produce the diagonal. This does not capture correlation among the variables but it does not require a potentially expensive matrix inversion.</p>
<p>Random variables with both scalar batch and event shape are not supported as <code>tf.hessians</code> is currently not applicable to scalars.</p>
<p>Note that <code>Laplace</code> finds the location parameter of the normal approximation using <code>MAP</code>, which is performed on the latent variable’s original (constrained) support. The scale parameter is calculated by evaluating the Hessian of <span class="math inline">\(-\log p(x, z)\)</span> in the constrained space and under the mode. This implies the Laplace approximation always has real support even if the target distribution has constrained support.</p>
<h4 id="examples">Examples</h4>
<pre class="python"><code>X = tf.placeholder(tf.float32, [N, D])
w = Normal(loc=tf.zeros(D), scale=tf.ones(D))
y = Normal(loc=ed.dot(X, w), scale=tf.ones(N))

qw = MultivariateNormalTriL(
    loc=tf.Variable(tf.random_normal([D])),
    scale_tril=tf.Variable(tf.random_normal([D, D])))

inference = ed.Laplace({w: qw}, data={X: X_train, y: y_train})</code></pre>
<h2 id="methods">Methods</h2>
<h3 id="__init__">
<code><strong>init</strong></code>
</h3>
<pre class="python"><code>__init__(
    latent_vars,
    data=None
)</code></pre>
<p>Create an inference algorithm.</p>
<h4 id="args">Args:</h4>
<ul>
<li><b><code>latent_vars</code></b>: list of RandomVariable or dict of RandomVariable to RandomVariable. Collection of random variables to perform inference on. If list, each random variable will be implictly optimized using a <code>MultivariateNormalTriL</code> random variable that is defined internally with unconstrained support and is initialized using standard normal draws. If dictionary, each random variable must be a <code>MultivariateNormalDiag</code>, <code>MultivariateNormalTriL</code>, or <code>Normal</code> random variable.</li>
</ul>
<h3 id="build_loss_and_gradients">
<code>build_loss_and_gradients</code>
</h3>
<pre class="python"><code>build_loss_and_gradients(var_list)</code></pre>
<p>Build loss function. Its automatic differentiation is the gradient of</p>
<p><span class="math inline">\(- \log p(x,z).\)</span></p>
<h3 id="finalize">
<code>finalize</code>
</h3>
<pre class="python"><code>finalize(feed_dict=None)</code></pre>
<p>Function to call after convergence.</p>
<p>Computes the Hessian at the mode.</p>
<h4 id="args-1">Args:</h4>
<ul>
<li><b><code>feed_dict</code></b>: dict. Feed dictionary for a TensorFlow session run during evaluation of Hessian. It is used to feed placeholders that are not fed during initialization.</li>
</ul>
<h3 id="initialize">
<code>initialize</code>
</h3>
<pre class="python"><code>initialize(
    *args,
    **kwargs
)</code></pre>
<h3 id="print_progress">
<code>print_progress</code>
</h3>
<pre class="python"><code>print_progress(info_dict)</code></pre>
<p>Print progress to output.</p>
<h3 id="run">
<code>run</code>
</h3>
<pre class="python"><code>run(
    variables=None,
    use_coordinator=True,
    *args,
    **kwargs
)</code></pre>
<p>A simple wrapper to run inference.</p>
<ol type="1">
<li>Initialize algorithm via <code>initialize</code>.</li>
<li>(Optional) Build a TensorFlow summary writer for TensorBoard.</li>
<li>(Optional) Initialize TensorFlow variables.</li>
<li>(Optional) Start queue runners.</li>
<li>Run <code>update</code> for <code>self.n_iter</code> iterations.</li>
<li>While running, <code>print_progress</code>.</li>
<li>Finalize algorithm via <code>finalize</code>.</li>
<li>(Optional) Stop queue runners.</li>
</ol>
<p>To customize the way inference is run, run these steps individually.</p>
<h4 id="args-2">Args:</h4>
<ul>
<li><b><code>variables</code></b>: list. A list of TensorFlow variables to initialize during inference. Default is to initialize all variables (this includes reinitializing variables that were already initialized). To avoid initializing any variables, pass in an empty list.</li>
<li><b><code>use_coordinator</code></b>: bool. Whether to start and stop queue runners during inference using a TensorFlow coordinator. For example, queue runners are necessary for batch training with file readers. *args, **kwargs: Passed into <code>initialize</code>.</li>
</ul>
<h3 id="update">
<code>update</code>
</h3>
<pre class="python"><code>update(feed_dict=None)</code></pre>
<p>Run one iteration of optimization.</p>
<h4 id="args-3">Args:</h4>
<ul>
<li><b><code>feed_dict</code></b>: dict. Feed dictionary for a TensorFlow session run. It is used to feed placeholders that are not fed during initialization.</li>
</ul>
<h4 id="returns">Returns:</h4>
<p>dict. Dictionary of algorithm-specific information. In this case, the loss function value after one iteration.</p>
<div id="refs" class="references">
<div id="ref-laplace1986memoir">
<p>Laplace, P. S. (1986). Memoir on the probability of the causes of events. <em>Statistical Science</em>, <em>1</em>(3), 364–378.</p>
</div>
</div>
    </div>
  </div>
  <div class="row" style="padding-bottom: 25%"> </div>
</div>
<script>
  hljs.initHighlightingOnLoad();
  renderMathInElement(document.body);
</script>
</body>
</html>
